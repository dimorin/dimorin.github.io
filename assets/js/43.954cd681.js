(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{209:function(t,e,r){"use strict";r.r(e);var n=r(0),s=Object(n.a)({},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[t._m(0),t._v(" "),r("p",[t._v("Caching, Offline, Native Reatures")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),r("ol",[t._m(6),t._v(" "),r("li",[r("strong",[t._v("네트워크 요청을 가로챌 수 있어")]),t._v(" 해당 자원에 대한 캐쉬 제공 또는 서버에 자원 요청\n"),r("ul",[r("li",[t._v("프로그래밍 가능한 네트워크 "),r("a",{attrs:{href:"https://ko.wikipedia.org/wiki/%ED%94%84%EB%A1%9D%EC%8B%9C_%EC%84%9C%EB%B2%84",target:"_blank",rel:"noopener noreferrer"}},[t._v("프록시"),r("OutboundLink")],1)])])]),t._v(" "),t._m(7),t._v(" "),r("li",[t._v("Web&Mobile Push 수신이 가능하도록 Notification 제공")]),t._v(" "),r("li",[t._v("navigator.serviceworker 로 접근")]),t._v(" "),t._m(8),t._v(" "),r("li",[t._v("Dom 에 직접적으로 접근이 불가능 - "),r("a",{attrs:{href:"https://developer.mozilla.org/ko/docs/Web/API/Web_Workers_API/basic_usage",target:"_blank",rel:"noopener noreferrer"}},[t._v("postMessage()"),r("OutboundLink")],1),t._v(" 이용")]),t._v(" "),t._m(9)]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),r("p",[r("a",{attrs:{href:"https://developers.google.com/web/fundamentals/primers/promises",target:"_blank",rel:"noopener noreferrer"}},[t._v("then? catch? - Promise"),r("OutboundLink")],1)]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),r("p",[t._v("-주의 : 캐쉬할 파일 중 한개라도 실패하면 전체 실패. 이를 해결하기 위해 sw-toolbox 사용 가능")]),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"service-worker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#service-worker","aria-hidden":"true"}},[this._v("#")]),this._v(" Service Worker")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"소개"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#소개","aria-hidden":"true"}},[this._v("#")]),this._v(" 소개")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("브라우저와 서버 사이의 미들웨어 역할을 하는 스크립트 파일")]),this._v(" "),e("li",[this._v("PWA에서 가장 중요한 역할을 하고, Offline Experience과 Mobile&Web Push의 기반기술")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"자바스크립트와의-차이점"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#자바스크립트와의-차이점","aria-hidden":"true"}},[this._v("#")]),this._v(" 자바스크립트와의  차이점")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("p",[r("code",[t._v("chrome://serviceworker-internals/")]),t._v("\n브라우저에서 돌아가고 있는 서비스워커를 확인할 수 있다.\n여기서 inspect 버튼을 클릭하고 콘솔창에"),r("code",[t._v("this")]),t._v("를 입력해보자.\n일반 브라우저에서 "),r("code",[t._v("this")]),t._v("는 windows를 가리키지만,\n서비스워커에서의 "),r("code",[t._v("this")]),t._v("는 service worker를 가리킨다.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"특징"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#특징","aria-hidden":"true"}},[this._v("#")]),this._v(" 특징")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("strong",[this._v("브라우저의 백그라운드에서 실행")]),this._v("되며 웹페이지와 별개의 라이프 싸이클을 가짐\n"),e("ul",[e("li",[this._v("Javascript UI 쓰레드랑 별도로 동작하는 또다른 쓰레드")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("strong",[this._v("브라우저 종속적인 생명주기로 백그라운드 동기화 기능 제공")]),this._v(" "),e("ul",[e("li",[this._v("Push 알람의 진입점을 제공")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[this._v("기존 Javascript 와의 "),e("strong",[this._v("별개의 자체 스코프")]),this._v("를 가짐\n"),e("ul",[e("li",[this._v("크롬 개발자 도구의 Console 과의 별개의 서비스워커 전용 Console 존재")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[this._v("사용하지 않을 때 "),e("strong",[this._v("자체적으로 종료, 필요시에 다시 동작")]),this._v("(event-driven 방식)")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"배경"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#배경","aria-hidden":"true"}},[this._v("#")]),this._v(" 배경")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("기존에 이미 존재하던 기술들을 "),e("strong",[this._v("보완 -> 그리고 진화")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"라이프-싸이클"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#라이프-싸이클","aria-hidden":"true"}},[this._v("#")]),this._v(" 라이프 싸이클")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",[r("li",[r("strong",[t._v("서비스워커는 웹 페이지와 별개의 생명주기")])]),t._v(" "),r("li",[t._v("서비스워커 등록 & 설치 & 활성화 과정을 잠깐 보면\n"),r("ol",[r("li",[r("strong",[t._v("웹페이지에서")]),t._v(" 서비스워커 스크립트 "),r("strong",[t._v("호출")])]),t._v(" "),r("li",[t._v("브라우저 "),r("strong",[t._v("백그라운드")]),t._v(" 에서 서비스 워커 "),r("strong",[t._v("설치")])]),t._v(" "),r("li",[r("strong",[t._v("설치과정")]),t._v("에서 정적 자원 "),r("strong",[t._v("캐싱")]),t._v("(Cache 실패시 Install 실패)")]),t._v(" "),r("li",[r("strong",[t._v("설치 후 활성화")]),t._v(". 네트워크 요청에 대한 가로채기 가능")])])]),t._v(" "),r("li",[t._v("사용하지 않을 때는 휴지 상태. 필요시에만 해당 기능 수행")]),t._v(" "),r("li",[t._v("메모리 상태에 따라 자체적으로 종료하는 영리함")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"등록"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#등록","aria-hidden":"true"}},[this._v("#")]),this._v(" 등록")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",[r("li",[t._v("웹브라우저에 등록")]),t._v(" "),r("li",[t._v("브라우저에 존재 유무를 확인 후 "),r("code",[t._v("register()")]),t._v("사용")]),t._v(" "),r("li",[t._v("index.html 같은 레벨에 sw.js 파일(서비스 워커 스크립트 파일)을 만들고 index.html 안에 아래의 코드를 입력한다.")]),t._v(" "),r("li",[t._v("서비스워커의 위치는 주 도메인과 같은 위치에 있어야 합니다.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("if ('serviceWorker'  in  navigator) {\n\tnavigator.serviceWorker.register('sw.js')\n\t.then(function (reg) {\n\t\tconsole.log('service worker 등록완료', reg);\n\t})\n\t.catch(function (err) {\n\t\tconsole.log('service worker 등록실패', err);\n\t});\n}\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"설치"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#설치","aria-hidden":"true"}},[this._v("#")]),this._v(" 설치")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",[r("li",[t._v("캐시를 설치")]),t._v(" "),r("li",[r("code",[t._v("register()")]),t._v("에서 등록한 스크립트 파일(sw.js)에서 "),r("code",[t._v("install()")]),t._v("호출")]),t._v(" "),r("li",[t._v("CACHE_NAME : 캐쉬를 담을 파일명 정의")]),t._v(" "),r("li",[t._v("filesToCache : 캐쉬할 웹 자원들 정의")]),t._v(" "),r("li",[r("code",[t._v("waitUntil()")]),t._v(" : 안의 로직이 수행될 때 까지 대기")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// 캐싱 스토리지에 저장될 파일 이름\nvar  CACHE_NAME  =  'pwa-offline-v1';\n// 캐싱할 파일 목록\nvar  filesToCache  = [\n\t'/',\n\t'/css/app.css'\n];\n// 서비스 워커 설치 (웹 자원 캐싱)\nself.addEventListener('install', function(event) {\n\t//캐쉬 등록 또는 기타 로직 수행\n\tevent.waitUntil(\n\t\tcaches.open(CACHE_NAME)\n\t\t.then(function(cache) {\n\t\t\t// 위에 지정한 캐쉬 목록을 'pwa-offline-v1' 캐쉬에 추가\n\t\t\treturn  cache.addAll(filesToCache);\n\t\t})\n\t\t.catch(function(error){\n\t\t\treturn  console.log(error);\n\t\t})\n\t);\n});\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"네트워크-요청-응답"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#네트워크-요청-응답","aria-hidden":"true"}},[this._v("#")]),this._v(" 네트워크 요청 응답")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",[r("li",[t._v("서비스워커 설치 후 캐쉬된 자원에 대한 네트워크 요청이 있을 때는 캐쉬로 돌려준다.")]),t._v(" "),r("li",[r("code",[t._v("responWith()")]),t._v(" : 네트워크 요청 가로채기 및 캐쉬 응답")]),t._v(" "),r("li",[r("code",[t._v("match()")]),t._v(": 해당 request에 상응하는 캐쉬가 있으면 찾아서 돌려주고 아니면 fetch()로 자원획득")]),t._v(" "),r("li",[t._v("개발자도구 Network 패널의 offline 체크 후 캐쉬응답 확인")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("self.addEventListener('fetch', function(event){\n\tevent.respondWith(\n\t\tcaches.match(event.request)\n\t\t.then(function(response){\n\t\t\treturn  response  ||  fetch(event.request);\n\t\t})\n\t\t.catch(function(error){\n\t\t\treturn  console.log(error);\n\t\t})\n\t);\n});\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"활성화-및-업데이트"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#활성화-및-업데이트","aria-hidden":"true"}},[this._v("#")]),this._v(" 활성화 및 업데이트")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("새로운 서비스워커가 설치되면 활성화 단계로 넘어온다.")]),this._v(" "),e("li",[this._v("이전에 사용하던 서비스워커와 이전 캐쉬는 모두 삭제하는 작업진헹")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("self.addEventListener('activate', function(event) {\n\tvar  cacheWhitelist  = ['v2'];\n\tevent.waitUntil(\n\t\tcaches.keys()\n\t\t.then(function(keyList) {\n\t\t\treturn  Promise.all(\n\t\t\t\tkeyList.map(function(key) {\n\t\t\t\t\tif (cacheWhitelist.indexOf(key) ===  -1) {\n\t\t\t\t\t\treturn  caches.delete(key);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t})\n\t\t.catch(function(error){\n\t\t\treturn  console.log(error);\n\t\t})\n\t);\n});\n")])])])}],!1,null,null,null);e.default=s.exports}}]);