<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>event loop | DIMORIN BLOG</title>
    <meta name="description" content="study study">
    
    
    <link rel="preload" href="/assets/css/0.styles.93a325d7.css" as="style"><link rel="preload" href="/assets/js/app.35dc46be.js" as="script"><link rel="preload" href="/assets/js/36.b0acade4.js" as="script"><link rel="prefetch" href="/assets/js/10.74f666ad.js"><link rel="prefetch" href="/assets/js/11.6b8a05b9.js"><link rel="prefetch" href="/assets/js/12.fa156fee.js"><link rel="prefetch" href="/assets/js/13.527367b9.js"><link rel="prefetch" href="/assets/js/14.fa4e7227.js"><link rel="prefetch" href="/assets/js/15.5595fdef.js"><link rel="prefetch" href="/assets/js/16.a75f793b.js"><link rel="prefetch" href="/assets/js/17.a3c4fd35.js"><link rel="prefetch" href="/assets/js/18.60c404b4.js"><link rel="prefetch" href="/assets/js/19.23d295eb.js"><link rel="prefetch" href="/assets/js/2.d80a531b.js"><link rel="prefetch" href="/assets/js/20.41c168c0.js"><link rel="prefetch" href="/assets/js/21.5a2de49f.js"><link rel="prefetch" href="/assets/js/22.14157b97.js"><link rel="prefetch" href="/assets/js/23.39b3f256.js"><link rel="prefetch" href="/assets/js/24.0d3e5a92.js"><link rel="prefetch" href="/assets/js/25.e68ee1e3.js"><link rel="prefetch" href="/assets/js/26.3481677b.js"><link rel="prefetch" href="/assets/js/27.66ba9ef5.js"><link rel="prefetch" href="/assets/js/28.5e830823.js"><link rel="prefetch" href="/assets/js/29.7ab430ad.js"><link rel="prefetch" href="/assets/js/3.85f1e40d.js"><link rel="prefetch" href="/assets/js/30.48c163b8.js"><link rel="prefetch" href="/assets/js/31.68b5027e.js"><link rel="prefetch" href="/assets/js/32.606aca05.js"><link rel="prefetch" href="/assets/js/33.50a55636.js"><link rel="prefetch" href="/assets/js/34.d975e645.js"><link rel="prefetch" href="/assets/js/35.68778a90.js"><link rel="prefetch" href="/assets/js/37.c0a4b5f7.js"><link rel="prefetch" href="/assets/js/38.1f5e5ceb.js"><link rel="prefetch" href="/assets/js/39.b1737324.js"><link rel="prefetch" href="/assets/js/4.77bd5cf5.js"><link rel="prefetch" href="/assets/js/40.b3046a9d.js"><link rel="prefetch" href="/assets/js/41.4f9c58fe.js"><link rel="prefetch" href="/assets/js/42.52df2078.js"><link rel="prefetch" href="/assets/js/43.5e43be4f.js"><link rel="prefetch" href="/assets/js/44.b9c647a3.js"><link rel="prefetch" href="/assets/js/45.e7e43eb5.js"><link rel="prefetch" href="/assets/js/46.71f00a9a.js"><link rel="prefetch" href="/assets/js/47.df67c5ca.js"><link rel="prefetch" href="/assets/js/48.e69bd965.js"><link rel="prefetch" href="/assets/js/49.0f16f5a5.js"><link rel="prefetch" href="/assets/js/5.6e1f6202.js"><link rel="prefetch" href="/assets/js/50.ac5c3968.js"><link rel="prefetch" href="/assets/js/51.071a2250.js"><link rel="prefetch" href="/assets/js/52.96c0ecd8.js"><link rel="prefetch" href="/assets/js/6.a1e0dbf3.js"><link rel="prefetch" href="/assets/js/7.c5e0407d.js"><link rel="prefetch" href="/assets/js/8.1730c26e.js"><link rel="prefetch" href="/assets/js/9.92e0dcc7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.93a325d7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DIMORIN BLOG</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/es6/" class="nav-link">ES6</a></div><div class="nav-item"><a href="/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/staticsite/" class="nav-link">Static Site</a></div><div class="nav-item"><a href="/pwa/" class="nav-link">PWA</a></div><div class="nav-item"><a href="/tool/" class="nav-link router-link-active">프론트엔드개발툴</a></div><div class="nav-item"><a href="/python/" class="nav-link">Python</a></div><div class="nav-item"><a href="/webgl/" class="nav-link">WebGL</a></div><div class="nav-item"><a href="/dv/" class="nav-link">데이터시각화</a></div><div class="nav-item"><a href="/about.html" class="nav-link">ABOUT</a></div><div class="nav-item"><a href="/deskg.html" class="nav-link">DESK.G</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/es6/" class="nav-link">ES6</a></div><div class="nav-item"><a href="/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/staticsite/" class="nav-link">Static Site</a></div><div class="nav-item"><a href="/pwa/" class="nav-link">PWA</a></div><div class="nav-item"><a href="/tool/" class="nav-link router-link-active">프론트엔드개발툴</a></div><div class="nav-item"><a href="/python/" class="nav-link">Python</a></div><div class="nav-item"><a href="/webgl/" class="nav-link">WebGL</a></div><div class="nav-item"><a href="/dv/" class="nav-link">데이터시각화</a></div><div class="nav-item"><a href="/about.html" class="nav-link">ABOUT</a></div><div class="nav-item"><a href="/deskg.html" class="nav-link">DESK.G</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/tool/" class="sidebar-link">프론트엔드 환경 구축</a></li><li><a href="/tool/designpattern.html" class="sidebar-link">디자인 패턴</a></li><li><a href="/tool/npm.html" class="sidebar-link">npm</a></li><li><a href="/tool/sass.html" class="sidebar-link">SASS</a></li><li><a href="/tool/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/tool/firebase.html" class="sidebar-link">Firebase</a></li><li><a href="/tool/git.html" class="sidebar-link">git</a></li><li><a href="/tool/nodejs.html" class="sidebar-link">Node.js</a></li><li><a href="/tool/gulp.html" class="sidebar-link">gulp</a></li><li><a href="/tool/eventloop.html" class="active sidebar-link">event loop</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tool/eventloop.html#프로세스와-쓰레드" class="sidebar-link">프로세스와 쓰레드</a></li><li class="sidebar-sub-header"><a href="/tool/eventloop.html#자바스크립트-런타임-환경-엔진이해-스택개념정리" class="sidebar-link">자바스크립트 런타임 환경(엔진이해, 스택개념정리)</a></li><li class="sidebar-sub-header"><a href="/tool/eventloop.html#브라우저-런타임-환경이해-큐-개념-정리" class="sidebar-link">브라우저 런타임 환경이해(큐 개념 정리)</a></li><li class="sidebar-sub-header"><a href="/tool/eventloop.html#정리" class="sidebar-link">정리</a></li></ul></li></ul> </div> <div class="page"> <div class="content"><h1 id="event-loop"><a href="#event-loop" aria-hidden="true" class="header-anchor">#</a> event loop</h1> <h2 id="프로세스와-쓰레드"><a href="#프로세스와-쓰레드" aria-hidden="true" class="header-anchor">#</a> 프로세스와 쓰레드</h2> <blockquote><p><a href="https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html" target="_blank" rel="noopener noreferrer">https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h3 id="프로세스"><a href="#프로세스" aria-hidden="true" class="header-anchor">#</a> 프로세스</h3> <p>: 컴퓨터 위에서 운영체제 위에서 연속적으로 실행되고 있는 프로그램을 말한다.
: 운영체제 위에서 독립적으로 메모리에서 실행되고 있는 프로그램을 말한다.
: 각각의 프로세스는 저마다 리소스 자원들이 정해져 있다.즉 프로세스마다 할당된 메모리나 데이터들이 지정되어져 있다.</p> <h4 id="프로세스-code"><a href="#프로세스-code" aria-hidden="true" class="header-anchor">#</a> 프로세스 - code</h4> <p>: 프로세스 안에는 프로그램을 위해서 작성된 코드 즉 프로그램을 실행하기 위한 코드가 들어있다.</p> <h4 id="프로세스-stack"><a href="#프로세스-stack" aria-hidden="true" class="header-anchor">#</a> 프로세스 - stack</h4> <p>: 그 코드와 그 프로세스 안에서 함수들이 어떤 순서로 실행되어야 하는지 이 함수가 끝나면 어디로 다시 돌아가야 되는지에 대한 정보를 저장하고 있는 스택이 들어있다.</p> <h4 id="프로세스-heap"><a href="#프로세스-heap" aria-hidden="true" class="header-anchor">#</a> 프로세스 - heap</h4> <p>: 힙은 오브젝트를 생성하거나 데이터를 만들때 그 데이터들이 저장되는 공간이다.
힙에는 동적으로 할당된 변수들이 저장되는 반면에</p> <h4 id="프로세스-data"><a href="#프로세스-data" aria-hidden="true" class="header-anchor">#</a> 프로세스 - data</h4> <p>: 데이터에는 전역 변수나 스태틱 변수들이 할당되어진다.
<br>
그래서 각각의 프로세스는 자기들에게 필요한 코드 그리고 동작하고 있는 순서를 기억하는 스택
데이터들이 들어있는 힙과 데이터 이런 것들이 각각 들어있다.
<br></p> <h3 id="쓰레드"><a href="#쓰레드" aria-hidden="true" class="header-anchor">#</a> 쓰레드</h3> <p>쓰레드는 한 프로세스 안에서 여러 개가 동작할 수 있는데
쓰레드는 각각 저마다 해야되는 업무를 배정받는다. 일명 일꾼.
저마다 필요한 일들을 수행하게 되고 이 쓰레드는 자기들만의 수행해야 되는 함수의 호출을 기억해야 되기 때문에 쓰레드마다 스택이 할당되어져 있다.
하지만 이 프로세스 안에서 동작하는 일꾼들은 결국은 한 프로그램을 위해서 일해야 되므로
프로세스에 지정된 코드와 데이터 힙들을 공통적으로 접근해서 공통적으로 업데이트가 가능하다.
즉 내 프로그램에서 음악을 들으면서 사진을 편집할 수 있는 어플리케이션이 있다면 각각 쓰레드 음악을 재생하는 쓰레드 하나와 사진을 편집할 수 있는 쓰레드
그리고 다른 쓰레드에서는 이 음악의 데이터를 서버에서부터 받아와서 처리하는 이런 일들을 각각 저마다 할 수 있다.
그리고 이런 쓰레드는 동시다발적으로 발생할 수 있기 때문에 이 프로세스가 조금 더 효율적으로 일을 할 수 있도록 도움을 준다.
만약에 프로세스가 하나의 일 밖에 하지 못한다면 음악을 듣는 동안 사진 편집을 할 수가 없다.
이렇게 쓰레드들이 안에 들어있기 때문에 다양한 일들을 동시에 할 수가 있다.
여기서 포인트는, 쓰레드는 자신들이 일을 수행할 때 어디에서부터 어디까지 일을 했고 그 다음엔 어디로 가야 되는지 이런 일의 흐름을 기억할 수 있는 고유의 스택이 지정되어져 있지만,
데이터나 코드나 힙 같은 공통적인 데이터 리소스는 프로세스에 있기 때문에 쓰레드들은 이 프로세스에 공통적으로 할당된 리소스에 동시다발적으로 접속해서 동시다발적으로 업데이트 해야 되서 서로 공유하면서 사용한다.
그래서 멀티쓰레딩이 조금 어려운 이유는 그리고 멀티 쓰레딩을 잘못하면 공통적으로 업데이트하면서 이 순서가 맞지 않거나 하면 발생할 수 있는 문제가 조금 있다.
<br> <br>
프로세스는 프로그래밍을 동작하는 최고의 단위이고, 쓰레드는 프로그램 안에서 동시에 여러개가 수행될 수 있는 작은 일꾼 단위이다.
<br></p> <h2 id="자바스크립트-런타임-환경-엔진이해-스택개념정리"><a href="#자바스크립트-런타임-환경-엔진이해-스택개념정리" aria-hidden="true" class="header-anchor">#</a> 자바스크립트 런타임 환경(엔진이해, 스택개념정리)</h2> <blockquote><p><a href="https://joshua1988.github.io/web-development/translation/javascript/how-js-works-inside-engine/" target="_blank" rel="noopener noreferrer">https://joshua1988.github.io/web-development/translation/javascript/how-js-works-inside-engine/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>자바스크립트는 single Threaded 이다.
<br>
자바스크립트 언어 자체에는 멀티쓰레딩을 할 수 있는 방법은 없지만
<br>
이 자바스크립트가 동작하고 있는 브라우저 위에는 여러가지 쓰레드가 들어있다.
그래서 브라우저 즉 웹 APIs 들을 이용하게 되면 멀티쓰레딩이 가능하다.
자바스크립트가 동작하는 런타임 환경에서 즉 자바스크립트가 동작하고 있는 실행 환경에서는 다양한 방식을 이용해서 조금 멀티쓰레딩 같은 효과를 얻을 수 있다.
<br>
자바스크립트가 실행되는 이 런타임 환경에서는 즉 자바스크립트가 실행되는 실행 환경 위에서는 이런 멀티쓰레딩 뿐만 아니라 이벤트 루프를 이용해서 조금 더 다양한 동작을 실행할 수 있다.</p> <h3 id="javascript-engine"><a href="#javascript-engine" aria-hidden="true" class="header-anchor">#</a> javascript engine</h3> <p>웹 어플리케이션이 브라우저 위에 올라가는 순간 자바스크립트 엔진이 우리가 작성한 소스 코드를 한 줄 한 줄 해석하고 분석하고 실행하게 된다.
어떤 구조인가.
javascript engine
memory heap, call stack
할당된 데이터들이 메모리 힙에 들어간다.
콜스택은 우리가 함수를 실행하는 순서에 따라서 차곡차곡 쌓아놓는다.</p> <h3 id="스택"><a href="#스택" aria-hidden="true" class="header-anchor">#</a> 스택</h3> <p>스택은 LIFO 라고도 불린다. last in first out 하는 자료구조를 가지고 있다.</p> <h2 id="브라우저-런타임-환경이해-큐-개념-정리"><a href="#브라우저-런타임-환경이해-큐-개념-정리" aria-hidden="true" class="header-anchor">#</a> 브라우저 런타임 환경이해(큐 개념 정리)</h2> <blockquote><p><a href="https://velog.io/@thms200/Event-Loop-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84" target="_blank" rel="noopener noreferrer">https://velog.io/@thms200/Event-Loop-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>자바스크립트 런타임 환경애서는 자바스크립트만으로는 할 수 있는 것이 한정적이다.<br>
하지만 웹APIs(DOM API, setTimeout, setInterval, fetch, event listener,...)는 할 수 있는 것들이 많다.<br>
웹 APIs는 브라우저에서 제공하는 API 이기 때문에 브라우저의 멀티쓰레딩을 이용해서 조금 더 다양한 일들을 동시에 실행할 수 있다.
<br><br>
자바스크립트 엔진에는 콜 스택이 있고 콜스택은 순서대로 함수들이 실행하는 것을 담고 있다.<br>
그럼 이 웹 APIs를 통해서 우리가 등록한 콜백 함수는 어떻게 동작하는가?<br>
어떻게 웹APIs와 자바스크립트 엔진이 서로 일을 하게 되는 건가?<br> <br><br>
예를 들어 setTimeout을 호출했다고 가정하면,
setTimeout을 호출하는 순간
setTimeout은 콜백에서 지워지고
웹 API는 타이머를 시작한다.<br>
타이머가 실행되고 있는 동안에도 즉 타이머와 자바스크립트 엔진은 병렬적으로 실행이 되고 있다가
지정된 시간이 끝나면 웹APIs는 태스크 큐에 타이머 끝났어 여기 네가 등록한 콜백이야 이 콜백 자체를 태스크 큐에 집어 넣는다.
이렇게 지정된 setTimeout이 끝나게 되면, 우리가 setTimeout을 호출할 때 콜백을 등록하잖아요 그 콜백이 태스크 큐에 들어오게 되요.<br>
이벤트 루프는 프로세스가 동작하는 동안 계속 루프를 돌면서 콜 스택이 비어져 있다면 테스크 큐에 들어 있는 아이를 콜 스택으로 가져와서 자바스크립트 엔진이 수행할 수 있도록 도와준다.</p> <h3 id="queue"><a href="#queue" aria-hidden="true" class="header-anchor">#</a> queue</h3> <p>FIFO ( first in first out )</p> <h3 id="이벤트-루프"><a href="#이벤트-루프" aria-hidden="true" class="header-anchor">#</a> 이벤트 루프</h3> <p>: 콜 스택과 태스크 큐를 관찰한다.
: 이벤트 루프는 프로세스가 동작하는 동안 계속 루프를 돌면서 콜 스택이 비어져 있다면 테스크 큐에 들어 있는 아이를 콜 스택으로 가져와서 자바스크립트 엔진이 수행할 수 있도록 도와준다.</p> <h2 id="정리"><a href="#정리" aria-hidden="true" class="header-anchor">#</a> 정리</h2> <p>: 자바스크립트 엔진에는 메모리 힙과 콜스택이 있다.<br>
: 콜스택은 함수가 실행되는 과정을 기억하기 위해서 쓰이는 자료구조이다.<br>
: 자바스크립트 런타임 환경에는 태스크 큐, 마이크로태스크 큐를 이용해서 비동기적인 처리를 하게 되는데 <br>
: 태스크 큐는 한 번에 하나씩만 가지고 오고 마이크로 태스크 큐는 들어있는 아이들은 모두 다 수행할 때까지 가지고 오게 되고<br>
: 렌더는 이벤트 루프가 주기적으로(매번은 아니지만) 브라우저에게 UI를 업데이트 하기 위해서 자주 들러준다.<br>
: 우리가 호출한 리퀘스트 애니메이션 프레임 콜백 큐는 이 업데이트가 일어나기 전에 한번 쭉 순회하면서 코두가 실행이 된다.<br>
: 웹 APIs에서 우리가 등록한 콜백을 특정한 이벤트가 발생하게 되면 태스크 큐에 넣어서 이 이벤트 루프라는 아이가 계속 감시하면서 콜스택이 비어져 있을 때 태스크 큐에 있는 아이를 하나씩 콜 스택으로 가져온다.<br>
: 콜 스택에서 수행중인 아이는 끝날때까지 보장이된다.</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/tool/gulp.html" class="prev">
          gulp
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.35dc46be.js" defer></script><script src="/assets/js/36.b0acade4.js" defer></script>
  </body>
</html>
